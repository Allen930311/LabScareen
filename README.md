Chemical Bottle Scanner - Ultimate Edition 🧪📦這是一個基於 Python 與 OpenCV 開發的實驗室藥品盤點系統。透過 Webcam 掃描藥罐上的 CAS Number，自動比對庫存清單，並在盤點結束後自動產生缺漏報告。核心功能：🎥 即時掃描：透過鏡頭讀取藥罐標籤。⏳ 視覺暫留 (Smart Freeze)：掃描成功後，結果鎖定螢幕 3 秒，方便確認。📝 歷史清單 (History Sidebar)：螢幕右側顯示最近掃描的 8 筆紀錄。📂 GUI 檔案選擇：啟動時彈出視窗選擇 CSV，無需修改程式碼。🌏 中文支援：完美支援中文 CSV 標題（上層藥品名稱、廠牌等）與 UTF-8 編碼。📊 自動報告：結束時自動匯出 missing_report.csv 缺漏清單。🛠️ 安裝需求 (Requirements)在使用本系統前，請確保您的電腦已安裝以下軟體：1. Python 3.x請確保已安裝 Python。2. Tesseract OCR (關鍵!)這是文字辨識引擎，必須額外安裝。下載位址: Tesseract-OCR Windows Installer安裝路徑: 預設建議安裝於 C:\Program Files\Tesseract-OCR設定: 請確認程式碼中的 TESSERACT_PATH 指向您的 tesseract.exe。3. Python 套件請打開終端機 (Terminal / CMD)，執行以下指令安裝所需套件：Bashpip install opencv-python pytesseract pandas numpy thefuzz python-Levenshtein
🚀 如何使用 (Usage)步驟 1：準備庫存清單 (CSV)您的 CSV 檔案必須包含以下資訊（支援中文標題）：CAS (必填)上層藥品名稱廠牌數量100-66-3AnisoleSIGMA500ml64-17-5EthanolACROS1L注意：存檔時請選擇 CSV UTF-8 (逗號分隔) 或使用程式提供的 fix_csv.py 產生，以避免亂碼。重要：如果藥品名稱中有逗號（例如 1,1'-biphenyl），請確保該欄位有被雙引號包起來。步驟 2：執行程式在終端機中執行主程式：Bashpython scanner_final.py
步驟 3：操作流程選擇檔案：程式啟動後，會跳出視窗，請選擇您的 .csv 庫存檔。開始掃描：將鏡頭對準藥罐標籤上的 CAS Number (例如 100-66-3)。綠色框框出現並顯示 "MATCH FOUND" 代表成功。右側 History 欄位會記錄已掃描的項目。結束盤點：按下鍵盤上的 Q 鍵退出程式。查看報告：程式會自動在 CSV 同目錄下產生 missing_report_日期時間.csv，列出所有未掃描到的藥品。⚠️ 常見問題與故障排除 (Troubleshooting)Q1: 程式出現 TesseractNotFound Error原因：電腦找不到 OCR 引擎。解法：請檢查程式碼第 30 行 TESSERACT_PATH 是否正確指向您的安裝路徑（例如 C:\Program Files\Tesseract-OCR\tesseract.exe）。Q2: 掃描不到手寫標籤？原因：Tesseract OCR 主要是設計給電腦印刷字體使用的，對手寫字的辨識率極低。解法：請使用標籤機列印標籤。或是手寫時使用極粗的黑色奇異筆，並書寫工整的印刷體 (Block Letters)，避免連筆草寫。Q3: 鏡頭全黑或打不開解法：請嘗試修改程式碼中的 CAMERA_INDEX，將 0 改為 1 或 2 試試看。Q4: CSV 讀取錯誤 Expected 4 fields, saw 5原因：您的藥品名稱中含有逗號，導致 CSV 欄位切分錯誤。解法：請使用專案附帶的修復工具重新生成 CSV，或用 Excel 存檔為標準 CSV 格式。📝 開發者筆記Language: Python 3.10+Libraries: OpenCV, Pandas, TesseractAuthor: [Your Name/Lab Name]Last Updated: 2026/01/19
